# üîî –ù–ê–°–¢–†–û–ô–ö–ê –§–û–ù–û–í–´–• PUSH-–£–í–ï–î–û–ú–õ–ï–ù–ò–ô

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ñ–æ–Ω–µ.

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### 1. –í—ã–ø–æ–ª–Ω–∏ SQL –≤ Supabase Dashboard
–ó–∞–π–¥–∏ –≤ Supabase ‚Üí SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏ –≤–µ—Å—å –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞:
```
supabase-webhook-trigger.sql
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –¢–∞–±–ª–∏—Ü—É –ª–æ–≥–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 2. –ù–∞—Å—Ç—Ä–æ–π Edge Function (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
Edge Function —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Ñ–∞–π–ª–µ:
```
supabase/functions/send-push-notification/index.ts
```

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏:
```sql
-- –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
SELECT test_push_notification_manual(
  '29f5dae6-e50b-4790-8264-5c9af05c5065'::UUID,
  '–¢–µ—Å—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞',
  '–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è'
);

-- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
SELECT * FROM push_notification_log ORDER BY created_at DESC LIMIT 5;
```

### 4. –¢–µ—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è

1. **–°–æ–∑–¥–∞–π –∑–∞–∫–∞–∑** –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. **–ü—Ä–∏–º–∏ –∑–∞–∫–∞–∑** –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å  
3. **–ó–∞–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ò–∑–º–µ–Ω–∏ —Å—Ç–∞—Ç—É—Å** –∑–∞–∫–∞–∑–∞ –Ω–∞ "–≤ –ø—É—Ç–∏"
5. **–ü—Ä–æ–≤–µ—Ä—å** - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Ñ–æ–Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
```sql
-- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞–Ω
SELECT * FROM information_schema.triggers 
WHERE trigger_name = 'trigger_auto_send_push_notifications';

-- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
SELECT * FROM push_notification_log 
WHERE created_at > NOW() - INTERVAL '1 hour'
ORDER BY created_at DESC;
```

### –ï—Å–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å —Ç–æ–∫–µ–Ω—ã –≤ –±–∞–∑–µ**:
```sql
SELECT * FROM push_tokens ORDER BY created_at DESC LIMIT 5;
```

2. **–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∑–∞–∫–∞–∑—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è**:
```sql
SELECT id, status, updated_at FROM orders 
ORDER BY updated_at DESC LIMIT 5;
```

3. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**:
```sql
SELECT * FROM push_notification_log 
WHERE status = 'error' 
ORDER BY created_at DESC;
```

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞** ‚Üí SQL —Ç—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–¢—Ä–∏–≥–≥–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã push_tokens
3. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ Firebase FCM
4. **–†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏** - —ç—Ç–æ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞!

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ **–§–æ–Ω–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–æ–¥–∏—Ç–µ–ª—è–º** –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º** –æ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

---

**–¢–µ–ø–µ—Ä—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏!** üéØ