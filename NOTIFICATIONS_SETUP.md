# üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–ª–∞–≥–∏–Ω** `@capacitor/push-notifications`
2. **–°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å** `src/services/notifications.ts` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
3. **–°–æ–∑–¥–∞–Ω —Ö—É–∫** `src/hooks/useNotifications.ts` –¥–ª—è Realtime –ø–æ–¥–ø–∏—Å–æ–∫
4. **–ù–∞—Å—Ç—Ä–æ–µ–Ω Android** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
5. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ App** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üì± –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –î–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π:
- ‚úÖ **–ù–æ–≤—ã–π –∑–∞–∫–∞–∑** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –¥–∞–∂–µ –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- ‚úÖ **–û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞** - –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –æ—Ç–º–µ–Ω–∏–ª –∑–∞–∫–∞–∑

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚úÖ **–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç** - –≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª –∑–∞–∫–∞–∑
- ‚úÖ **–í–æ–¥–∏—Ç–µ–ª—å –≤—ã–µ—Ö–∞–ª** - —Å—Ç–∞—Ç—É—Å "–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
- ‚úÖ **–ó–∞–∫–∞–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω** - —Ä–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- ‚úÖ **–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω** - –∑–∞–∫–∞–∑ –±—ã–ª –æ—Ç–º–µ–Ω–µ–Ω

## üîß Realtime –ø–æ–¥–ø–∏—Å–∫–∏ (Supabase):

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Supabase Realtime** –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

```typescript
// –í–æ–¥–∏—Ç–µ–ª—å —Å–ª—É—à–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã
supabase
  .channel('new_orders')
  .on('postgres_changes', {
    event: 'INSERT',
    table: 'orders'
  }, handleNewOrder)
  .subscribe()

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ª—É—à–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–≤–æ–∏—Ö –∑–∞–∫–∞–∑–æ–≤
supabase
  .channel('user_orders')
  .on('postgres_changes', {
    event: 'UPDATE',
    table: 'orders',
    filter: `user_id=eq.${userId}`
  }, handleStatusChange)
  .subscribe()
```

## üöÄ –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Firebase Cloud Messaging:

### 1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Firebase:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.firebase.google.com
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
- –î–æ–±–∞–≤—å—Ç–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å package name: `io.github.yabuzuk.vodovozka`

### 2. –°–∫–∞—á–∞–π—Ç–µ google-services.json:
- –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ Firebase —Å–∫–∞—á–∞–π—Ç–µ `google-services.json`
- –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –≤ `android/app/google-services.json`

### 3. –û–±–Ω–æ–≤–∏—Ç–µ build.gradle:
```gradle
// android/build.gradle
dependencies {
    classpath 'com.google.gms:google-services:4.3.15'
}

// android/app/build.gradle
apply plugin: 'com.google.gms.google-services'
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å:
–°–æ–∑–¥–∞–π—Ç–µ Edge Function –≤ Supabase –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ FCM:

```typescript
// supabase/functions/send-notification/index.ts
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'

serve(async (req) => {
  const { token, title, body, data } = await req.json()
  
  const response = await fetch('https://fcm.googleapis.com/fcm/send', {
    method: 'POST',
    headers: {
      'Authorization': `key=${Deno.env.get('FCM_SERVER_KEY')}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      to: token,
      notification: { title, body },
      data
    })
  })
  
  return new Response(JSON.stringify({ success: true }))
})
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

–î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `NotificationTest` –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:

```typescript
import { NotificationTest } from '@/components/NotificationTest'

// –í –≤–∞—à–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
<NotificationTest />
```

## üìä –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–ë–µ–∑ Firebase** (—Ç–µ–∫—É—â–∞—è):
- ‚úÖ Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Supabase WebSocket
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ
- ‚úÖ –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≤–µ–±-–≤–µ—Ä—Å–∏–∏
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ù–ï –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã—Ç–æ

**–° Firebase** (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏):
- ‚úÖ –í—Å–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–∞–∂–µ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- ‚úÖ –ù–∞–¥–µ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Google FCM

## üîë API –∫–ª—é—á–∏:

### Supabase (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ):
```env
VITE_SUPABASE_URL=https://pmebqzbjtdmbaoqjfbev.supabase.co
VITE_SUPABASE_ANON_KEY=–≤–∞—à-–∫–ª—é—á
```

### –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ):
```env
VITE_YANDEX_MAPS_API_KEY=63c21778-deb0-4a95-bc2a-fb4d2dd46449
```

### Firebase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```env
FCM_SERVER_KEY=–≤–∞—à-server-key-–∏–∑-firebase
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

1. **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
2. Firebase –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
3. Realtime –ø–æ–¥–ø–∏—Å–∫–∏ Supabase —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Firebase –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
